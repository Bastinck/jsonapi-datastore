function JsonApiDataStoreModel(t,i){this.id=i,this._type=t,this._attributes=[],this._relationships=[]}function JsonApiDataStore(){this.graph={}}JsonApiDataStoreModel.prototype.serialize=function(t){var i=this,a={data:{type:this._type}};return t=t||{},t.attributes=t.attributes||this._attributes,t.relationships=t.relationships||this._relationships,void 0!==this.id&&(a.data.id=this.id),0!==t.attributes.length&&(a.data.attributes={}),0!==t.relationships.length&&(a.data.relationships={}),t.attributes.forEach(function(t){a.data.attributes[t]=i[t]}),t.relationships.forEach(function(t){function e(t){return{type:t._type,id:t.id}}a.data.relationships[t]=i[t].constructor===Array?{data:i[t].map(e)}:{data:e(i[t])}}),a},JsonApiDataStoreModel.prototype.setAttribute=function(t,i){void 0===this[t]&&this._attributes.push(t),this[t]=i},JsonApiDataStoreModel.prototype.setRelationship=function(t,i){void 0===this[t]&&this._relationships.push(t),this[t]=i},JsonApiDataStore.prototype.destroy=function(t){delete this.graph[t._type][t.id]},JsonApiDataStore.prototype.find=function(t,i){return this.graph[t]&&this.graph[t][i]?this.graph[t][i]:null},JsonApiDataStore.prototype.reset=function(){this.graph={}},JsonApiDataStore.prototype.initModel=function(t,i){return this.graph[t]=this.graph[t]||{},this.graph[t][i]=this.graph[t][i]||new JsonApiDataStoreModel(t,i),this.graph[t][i]},JsonApiDataStore.prototype.syncRecord=function(t){function i(t){if(!e.find(t.type,t.id)){var i=e.initModel(t.type,t.id);i._placeHolder=!0}return e.graph[t.type][t.id]}var a,e=this,o=this.initModel(t.type,t.id);delete o._placeHolder;for(a in t.attributes)o._attributes.push(a),o[a]=t.attributes[a];if(t.relationships)for(a in t.relationships){var r=t.relationships[a];void 0!==r.data&&(o._relationships.push(a),o[a]=null===r.data?null:r.data.constructor===Array?r.data.map(i):i(r.data)),r.links&&console.log("Warning: Links not implemented yet.")}return o},JsonApiDataStore.prototype.sync=function(t){var i=t.data,a=this.syncRecord.bind(this);return i?(t.included&&t.included.map(a),i.constructor===Array?i.map(a):a(i)):[]};